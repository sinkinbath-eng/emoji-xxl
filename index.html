<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÂèØÁà±Êâ´Èõ∑</title>
    <link href="https://fonts.googleapis.com/css2?family=Zhi+Mang+Xing&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Zhi Mang Xing', cursive;
            background: #ffe3e3; /* ÊµÖÁ≤âËâ≤ËÉåÊôØ */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            color: #333;
            padding: 20px;
            overflow: hidden;
        }

        .game-container {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            background-color: #fff0f5; /* ÁôΩËâ≤ÊàñÊµÖÁ≤âËâ≤ */
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            max-width: 95%;
        }
        
        h1 {
            font-size: 3rem;
            text-shadow: 2px 2px #ffc0cb; /* ÂèØÁà±Èò¥ÂΩ± */
            margin-bottom: 10px;
            color: #ff69b4; /* Á≤âËâ≤Ê†áÈ¢ò */
        }

        #game-board {
            display: grid;
            gap: 2px;
            border: 4px solid #ffb6c1;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(255, 182, 193, 0.8);
            background-color: #fff0f5;
        }

        .cell {
            width: 30px;
            height: 30px;
            background-color: #ffc0cb; /* ÊµÖÁ≤âËâ≤Ê†ºÂ≠ê */
            border-radius: 6px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.1s;
            user-select: none;
            color: transparent;
        }
        
        .cell:hover {
            transform: scale(1.05);
        }

        .cell.revealed {
            background-color: #fce4ec; /* Êè≠ÂºÄÂêéÁöÑÈ¢úËâ≤ */
            cursor: default;
        }
        
        .cell.bomb {
            background-color: #ff4d4d;
        }

        .cell.flagged {
            background-color: #ffde59;
        }

        .cell.revealed.number-1 { color: #0000ff; }
        .cell.revealed.number-2 { color: #008000; }
        .cell.revealed.number-3 { color: #ff0000; }
        .cell.revealed.number-4 { color: #000080; }
        .cell.revealed.number-5 { color: #800000; }
        .cell.revealed.number-6 { color: #008080; }
        .cell.revealed.number-7 { color: #000000; }
        .cell.revealed.number-8 { color: #808080; }
        
        .game-info {
            display: flex;
            justify-content: space-around;
            align-items: center;
            width: 100%;
            font-size: 1.5rem;
            font-weight: bold;
            color: #ff69b4;
            margin-top: 10px;
            gap: 20px;
        }

        .button {
            background-color: #ffb6c1;
            color: #333;
            padding: 10px 20px;
            font-family: 'Zhi Mang Xing', cursive;
            font-size: 1.5rem;
            font-weight: bold;
            border-radius: 10px;
            border: none;
            cursor: pointer;
            margin-top: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s ease-in-out, background-color 0.2s;
        }

        .button:hover {
            background-color: #ff99aa;
            transform: scale(1.05);
        }

        .message-box {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(255, 182, 193, 0.9);
            padding: 15px 30px;
            border-radius: 15px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
            z-index: 1000;
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
            animation: fadeIn 0.5s ease-out;
            max-width: 90%;
            transition: opacity 0.5s ease-in-out;
            pointer-events: none;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @media (max-width: 600px) {
            h1 {
                font-size: 2.5rem;
            }
            .game-info {
                font-size: 1.2rem;
                flex-direction: column;
                gap: 5px;
            }
            .message-box {
                font-size: 1.2rem;
                padding: 10px 20px;
            }
            .cell {
                width: 25px;
                height: 25px;
                font-size: 1rem;
            }
        }
    </style>
</head>
<body class="bg-gray-900 text-white font-sans flex flex-col items-center justify-center min-h-screen">
    <div class="game-container">
        <h1>ÂèØÁà±Êâ´Èõ∑</h1>
        
        <div id="game-start-screen">
            <button id="start-game-button" class="button">ÂºÄÂßãÊ∏∏Êàè</button>
        </div>
        
        <div id="game-ui" class="hidden">
            <div class="game-info">
                <div>Èõ∑Êï∞: <span id="mines-count">0</span></div>
                <div>Êó∂Èó¥: <span id="timer">0</span></div>
                <div>Â∑≤Êè≠Á§∫: <span id="revealed-count">0</span></div>
            </div>
            <div id="game-board" class="mt-4"></div>
            <button id="restart-button" class="button hidden">ÈáçÊñ∞ÂºÄÂßã</button>
        </div>
    </div>

    <script type="module">
        // Global variables
        const minesCountEl = document.getElementById('mines-count');
        const revealedCountEl = document.getElementById('revealed-count');
        const timerEl = document.getElementById('timer');
        const startGameBtn = document.getElementById('start-game-button');
        const restartButton = document.getElementById('restart-button');
        const startScreenEl = document.getElementById('game-start-screen');
        const gameUiEl = document.getElementById('game-ui');
        const gameBoardEl = document.getElementById('game-board');

        // Game settings
        const ROWS = 10;
        const COLS = 10;
        const NUM_MINES = 10;
        let gameBoard = [];
        let revealedCells = [];
        let flaggedCells = [];
        let gameStarted = false;
        let timerInterval;

        // Utility functions
        function showMessage(message) {
            const messageBox = document.createElement('div');
            messageBox.classList.add('message-box');
            messageBox.innerHTML = message;
            document.body.appendChild(messageBox);
            setTimeout(() => {
                messageBox.style.opacity = '0';
                setTimeout(() => messageBox.remove(), 500);
            }, 3000);
        }

        function createBoard() {
            let newBoard = Array(ROWS).fill(null).map(() => Array(COLS).fill(0));
            revealedCells = [];
            flaggedCells = [];
            
            // Place mines
            let minesPlaced = 0;
            while (minesPlaced < NUM_MINES) {
                const r = Math.floor(Math.random() * ROWS);
                const c = Math.floor(Math.random() * COLS);
                if (newBoard[r][c] !== 'bomb') {
                    newBoard[r][c] = 'bomb';
                    minesPlaced++;
                }
            }

            // Calculate adjacent mine counts
            for (let r = 0; r < ROWS; r++) {
                for (let c = 0; c < COLS; c++) {
                    if (newBoard[r][c] === 'bomb') continue;
                    let count = 0;
                    for (let dr = -1; dr <= 1; dr++) {
                        for (let dc = -1; dc <= 1; dc++) {
                            const nr = r + dr;
                            const nc = c + dc;
                            if (nr >= 0 && nr < ROWS && nc >= 0 && nc < COLS && newBoard[nr][nc] === 'bomb') {
                                count++;
                            }
                        }
                    }
                    newBoard[r][c] = count;
                }
            }
            return newBoard;
        }

        function drawBoard() {
            gameBoardEl.innerHTML = '';
            gameBoardEl.style.gridTemplateColumns = `repeat(${COLS}, 1fr)`;

            for (let r = 0; r < ROWS; r++) {
                for (let c = 0; c < COLS; c++) {
                    const cellEl = document.createElement('div');
                    cellEl.classList.add('cell');
                    cellEl.dataset.row = r;
                    cellEl.dataset.col = c;

                    const isRevealed = revealedCells.some(cell => cell.r === r && cell.c === c);
                    const isFlagged = flaggedCells.some(flag => flag.r === r && flag.c === c);

                    if (isRevealed) {
                        cellEl.classList.add('revealed');
                        const cellValue = gameBoard[r][c];
                        if (cellValue === 'bomb') {
                            cellEl.classList.add('bomb');
                            cellEl.textContent = 'üí£';
                        } else if (cellValue > 0) {
                            cellEl.textContent = cellValue;
                            cellEl.classList.add(`number-${cellValue}`);
                        }
                    } else if (isFlagged) {
                        cellEl.classList.add('flagged');
                        cellEl.textContent = 'üö©';
                    }

                    gameBoardEl.appendChild(cellEl);
                }
            }
        }
        
        function revealAllBombs() {
            for (let r = 0; r < ROWS; r++) {
                for (let c = 0; c < COLS; c++) {
                    if (gameBoard[r][c] === 'bomb') {
                        const cellEl = gameBoardEl.querySelector(`[data-row='${r}'][data-col='${c}']`);
                        if (cellEl && !flaggedCells.some(flag => flag.r === r && flag.c === c)) {
                            cellEl.classList.add('revealed', 'bomb');
                            cellEl.textContent = 'üí£';
                        }
                    }
                }
            }
        }

        function handleCellClick(event) {
            if (!gameStarted) return;

            const r = parseInt(event.target.dataset.row);
            const c = parseInt(event.target.dataset.col);
            const isRevealed = revealedCells.some(cell => cell.r === r && cell.c === c);
            const isFlagged = flaggedCells.some(flag => flag.r === r && flag.c === c);
            
            if (isRevealed) return;

            if (event.button === 0) { // Left click
                if (isFlagged) {
                    showMessage("ËØ∑ÂÖàÁßªÈô§ÊóóÂ∏ú!");
                    return;
                }
                
                if (gameBoard[r][c] === 'bomb') {
                    gameOver(false);
                } else {
                    revealCell(r, c);
                }
                
                checkWin();
                
            } else if (event.button === 2) { // Right click
                event.preventDefault();
                const cellIndex = flaggedCells.findIndex(flag => flag.r === r && flag.c === c);
                if (cellIndex !== -1) {
                    flaggedCells.splice(cellIndex, 1);
                } else {
                    flaggedCells.push({ r, c });
                }
                updateUI();
            }
        }
        
        function revealCell(r, c) {
            if (r < 0 || r >= ROWS || c < 0 || c >= COLS) return;
            if (revealedCells.some(cell => cell.r === r && cell.c === c)) return;
            if (flaggedCells.some(flag => flag.r === r && flag.c === c)) return;

            revealedCells.push({ r, c });

            if (gameBoard[r][c] === 0) {
                for (let dr = -1; dr <= 1; dr++) {
                    for (let dc = -1; dc <= 1; dc++) {
                        if (dr === 0 && dc === 0) continue;
                        revealCell(r + dr, c + dc);
                    }
                }
            }
            updateUI();
        }

        function checkWin() {
            const totalCells = ROWS * COLS;
            const nonMineCells = totalCells - NUM_MINES;
            if (revealedCells.length >= nonMineCells) {
                 gameOver(true);
            }
        }

        async function gameOver(hasWon) {
            clearInterval(timerInterval);
            gameStarted = false;
            
            if (hasWon) {
                const finalTime = parseInt(timerEl.textContent);
                showMessage(`‰Ω†Ëµ¢‰∫ÜÔºÅÁî®Êó∂ ${finalTime} Áßí üéâ`);
            } else {
                showMessage("Ê∏∏ÊàèÁªìÊùü...üò≠");
                revealAllBombs();
            }
            restartButton.classList.remove('hidden');
        }

        function updateUI() {
            minesCountEl.textContent = NUM_MINES;
            revealedCountEl.textContent = revealedCells.length;
            drawBoard();
        }
        
        function startGame() {
            gameBoard = createBoard();
            gameStarted = true;
            startScreenEl.classList.add('hidden');
            gameUiEl.classList.remove('hidden');
            restartButton.classList.add('hidden');
            updateUI();
            
            let time = 0;
            timerEl.textContent = time;
            timerInterval = setInterval(() => {
                time++;
                timerEl.textContent = time;
            }, 1000);
        }

        window.onload = function() {
            startGameBtn.addEventListener('click', startGame);
            restartButton.addEventListener('click', startGame);
            gameBoardEl.addEventListener('mousedown', handleCellClick);
            gameBoardEl.addEventListener('contextmenu', (e) => e.preventDefault());
        };

    </script>
</body>
</html>
